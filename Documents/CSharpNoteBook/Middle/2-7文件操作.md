# *.NET Core CSharp* 中级篇2-7
>本节内容为文件操作

## 简介
文件操作在我们C#里还是比较常见的，例如我们读取Excel、Txt文件的内容，在程序中，这些文件都是以流的方式读取进入我们内存中，本节内容会详细的讲解有关文件的操作的方法。

我们从最大的驱动器开始往文件这个最小的开始讲解

## 驱动器读取
在Windows操作系统中，存储介质统称为驱动器，硬盘由于可以划分为多个区域，每一个区域称为一个驱动器。.NET提供DriveInfo类和 DriveType枚举型，以方便在程序中直接使用驱动器。DriveInfo类的常用字段成员有DriveFormat(文件系统格式，如NTFS或FAT32)、DriveType(驱动器类型)、Name（驱动器名）、TotalSize(总空间)、TotalFreeSpace(获得驱动器可用空间)。常用的方法成员有GetDrives(获得可用驱动器列表)。

DriveType枚举型的枚举值有CDRom(光驱)、Fixed(硬盘)、Network(网络驱动器)和Removeable(软盘或U盘)等。例如，以下代码可以输出每一个硬盘驱动器的剩余空间信息。

``` C#
DriveInfo[] drivers = DriveInfo.GetDrives();
foreach(DriveInfo driver in drivers)
{
    if(driver.DriveType == DriveType.Fixed && driver.DriveFormat == "NTFS")
    {
        Console.WriteLine("在{0}驱动器上还有{1}字节的剩余空间。", driver.Name, driver.AvailableFreeSpace);
    }
}
Console.ReadLine();

```

## 目录
为了方便检索文件，需要在驱动器中先创建目录，然后把文件保存到这个目录中。在Windows操作系统中，目录又称文件夹。每个驱动器都有一个根目录，使用”\”表示，如”C:\”表示C驱动器的根目录。创建在根目录中的目录称为一级子目录。在一级子目录中创建的目录称为二级子目录，依此类推。文件系统的目录结构是一种树形结构。

.NET提供了Directory类和DirectoryInfo类，以方便在程序中直接操作目录。

Directory类的常用方法成员有CreateDirectory(创建新目录)、Delete(删除目录)、Exists(判断目录是否存在)、Move(移动目录)、GetFiles(获得目录的文件列表)、GetDirectories(获得子目录列表)等。

DirectoryInfo类的常用字段成员有Name(提取目录名)、Exists（判断目录是否存在）、Parent(父目录)、Root(根目录)、MoveTo(移动目录)、GetFiles(获得目录的文件列表)、GetDirectories(获得子目录列表)等。例如，以下代码分别展现了Directory类和DirectoryInfo类的基本方法。

``` C#
Directory.CreateDirectory(@"d:\C#程序设计");
if(Directory.Exists(@"d:\C#程序设计"))
{
    Console.WriteLine("创建成功");
}
Directory.Delete(@"d:\C#程序设计");
if (!Directory.Exists(@"d:\C#程序设计"))
{
    Console.WriteLine("删除成功");
}

DirectoryInfo dir = new DirectoryInfo(@"d:\C#程序设计");
if (!dir.Exists)
{
    dir.Create();
}
else
{
    Console.WriteLine("该目录已经存在");
}
```

## 文件
文件的操作主要是分为两个类，一个是File类，一个是FileInfo类。File和FileInfo类位于System.IO命名空间，都可以用来实现创建、复制、移动、打开文件等操作。File类和FileInfo类与Directory类和DirectoryInfo类的工作方式相似。File类是一个静态类，可直接调用其方法成员。FileInfo类不是静态类，需要先创建实例。

### File类
File类是一个文件的基本操作类，里面包含的大多都是实际操作文件的方法，我用一个列表表示它内部常用的方法
- Open(string path, FileMode mode)+3重载 打开指定路径文件
- Create(string path)+3重载，在指定路径创建文件，可以指定缓冲区大小
- Copy(string sourceFileName, string destFileName)，复制文件
- Delete(string path),删除文件
- Exists(),判断文件是否存在
- Move(string sourceFileName, string destFileName)，移动文件
- Replace(string sourceFileName,string destinationFileName,
string destinationBackupFileName)，替换文件
- AppendAllText(string path, string contents)新建文件并添加文本
- ReadAllText(string path, Encoding encoding)+2重载，打开并读取文本内容（可以指定打开的编码格式）

这些方法的使用也是非常简单，例如：

``` C#
string path = @"E:\test.txt";
//以路径为参数创建文件
File.Create(path);
```
更多的使用你最好自己去尝试，我们这几节的内容都是一些常用的类和方法的实际运用，并没有过多的知识点，你只需要按着这里的操作一直尝试即可。

### FileInfo类
FileInfo类也可以对文件进行操作，但是对于FileInfo类，你必须